package me.bait.exploitsx.exploits;

import me.bait.exploitsx.ExploitsX;
import me.bait.exploitsx.util.API;
import me.bait.exploitsx.util.ConfigHelper;
import org.bukkit.ChatColor;
import org.bukkit.block.Block;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.BlockPlaceEvent;
import org.bukkit.event.hanging.HangingPlaceEvent;

public class ChunkBan implements Listener {

    @EventHandler
    public void hangingPlace(HangingPlaceEvent event) {
        if (ExploitsX.getPlugin().getConfig().getBoolean("patchchunkban") && event.getBlock().getChunk().getEntities().length > ConfigHelper.getInt("ifentitymax", 600)) {
            event.getPlayer().sendMessage(ChatColor.translateAlternateColorCodes('&', (API.getPrefix()
                    + ConfigHelper.getString("chunkbanitemframemsg", "&aItem Frames are limited per chunk, sorry."))));
            event.setCancelled(true);
        }
    }

    @EventHandler
    public void onPlace(BlockPlaceEvent event) {
        if (ExploitsX.getPlugin().getConfig().getBoolean("patchchunkban")) {
            Block block = event.getBlock();
            Player player = event.getPlayer();
            if (API.isTile(block.getType().toString())
                    && (event.getBlock().getChunk().getTileEntities()).length > ExploitsX.getPlugin().getConfig()
                    .getInt("tileentitymax")) {
                event.setCancelled(true);
                player.sendMessage(
                        ChatColor.translateAlternateColorCodes('&',
                                ExploitsX.getPlugin().getConfig().getString("chunkbanmsg")));
            }

            int status = 0;
            String g = block.getType().toString();
            if (g.equals("SKULL")
                    || g.equals("PLAYER_HEAD")
                    || g.equals("CREEPER_HEAD")
                    || g.equals("ZOMBIE_HEAD")
                    || g.equals("WITHER_SKELETON_SKULL")
                    || g.equals("SKELETON_SKULL")
                    || g.equals("SKULL_ITEM"))
                status = 1;
            if (status == 1 && (block.getChunk().getTileEntities()).length > ExploitsX.getPlugin().getConfig()
                    .getInt("skullmax")) {
                event.setCancelled(true);
                player.sendMessage(ChatColor.translateAlternateColorCodes('&',
                        ExploitsX.getPlugin().getConfig().getString("chunkbanmsg")));
            }
        }
    }
}