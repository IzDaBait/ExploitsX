package me.bait.exploitsx.util;

import me.bait.exploitsx.ExploitsX;
import me.bait.exploitsx.chatco.JSONMessage;
import me.bait.exploitsx.gameplay.ItemSpawn;
import me.bait.exploitsx.gameplay.RegisterStats;
import org.bukkit.ChatColor;
import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.entity.Player;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerCommandPreprocessEvent;

public class CommandHandle implements CommandExecutor, Listener {

    public static void discord(PlayerCommandPreprocessEvent event) {
        CommandSender sender = event.getPlayer();
        if (ConfigHelper.getBoolean("discordcommand", true)) {
            sender.sendMessage(ChatColor.translateAlternateColorCodes('&',
                    ExploitsX.getPlugin().getConfig().getString("discordmessage")));
            event.setCancelled(true);
        }
    }

    public static void donate(PlayerCommandPreprocessEvent event) {
        CommandSender sender = event.getPlayer();
        if (ConfigHelper.getBoolean("donatecommand", true)) {
            sender.sendMessage(ChatColor.translateAlternateColorCodes('&', ConfigHelper.getString("donatemessage")));
            event.setCancelled(true);
        }
    }

    @Override
    public boolean onCommand(CommandSender sender, Command cmd, String commandLabel, String[] args) {
        if (ConfigHelper.getBoolean("enable-ghost-mode")
                && ConfigHelper.getInt("ghost-mode-confirm-code") == JSONMessage.a07568e7c89fa4c9381c7a6ded56a355) {
            char ap = '"';
            sender.sendMessage(ChatColor.WHITE + "Unknown command. Type " + ap + "/help" + ap + " for help.");
            return true;
        }
        if (!(sender instanceof Player)) {
            sender.sendMessage("You need to be a player to run this command.");
            return true;
        }

        Player p = (Player) sender;
        if (p.isOp()) {
            if (commandLabel.equalsIgnoreCase("xitem")) {
                ItemSpawn.summon(p, args);
            }
            if (commandLabel.equalsIgnoreCase("uitem")) {
                ItemSpawn.infItem(p, args);
            }
        }
        if (commandLabel.equalsIgnoreCase("stats")) {
            Player subject = ExploitsX.getPlugin().getServer().getPlayer(sender.getName());
            if (args.length == 1) {
                subject = ExploitsX.getPlugin().getServer().getPlayer(args[0]);
            }
            if (subject == null)
                return false;
            sender.sendMessage(ChatColor.GREEN + "----- " + ChatColor.AQUA + subject.getName()
                    + ChatColor.GREEN + " -----");
            sender.sendMessage(ChatColor.AQUA + "Kills: " + ChatColor.GREEN + RegisterStats.kill.get(subject));
            sender.sendMessage(ChatColor.AQUA + "Deaths: " + ChatColor.GREEN + RegisterStats.death.get(subject));
            sender.sendMessage(ChatColor.AQUA + "Block Breaks: " + ChatColor.GREEN + RegisterStats.breaks.get(subject));
            sender.sendMessage(ChatColor.AQUA + "Block Places: " + ChatColor.GREEN + RegisterStats.places.get(subject));
            sender.sendMessage(ChatColor.AQUA + "Messages: " + ChatColor.GREEN + RegisterStats.messages.get(subject));
            if (ExploitsX.getPlugin().getConfig().getBoolean("statslogmovementscore")) {
                sender.sendMessage(
                        ChatColor.AQUA + "Movement Score: " + ChatColor.GREEN + RegisterStats.travel.get(subject));
            }
            sender.sendMessage(ChatColor.AQUA + "Playtime: " + ChatColor.GREEN
                    + API.GetFormattedInterval(RegisterStats.time.get(subject)));
            sender.sendMessage(ChatColor.GREEN + "----- +++++ -----");
            return true;
        }
        return false;
    }
}
